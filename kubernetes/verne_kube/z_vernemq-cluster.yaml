apiVersion: vernemq.com/v1alpha1
kind: VerneMQ
metadata:
  labels:
    vernemq: k8s
  name: k8s
spec:
  baseImage: muhamedavila/vmq_dojot
  env:
    - name: STATIC_CERT
      value: "y"
    - name: K8S_ENV
      value: "y"
    - name: CERT_EJBCA_API_BROKER
      value: "ejbca-simple"
    - name: CERT_EJBCA_API_PORT
      value: "5583"
    ## BASE-64 config
    - name: VERNEMQ_CONF
      value: "bWV0YWRhdGFfcGx1Z2luID0gdm1xX3N3YwpsaXN0ZW5lci52bXEuY2x1c3RlcmluZyA9ICRNWV9QT0RfSVA6NDQwNTMKbGlzdGVuZXIuc3NsLmRlZmF1bHQgPSAwLjAuMC4wOjg4ODMKbGlzdGVuZXIuc3NsLmNhZmlsZSA9IC4vY2VydC9jYS5jcnQKbGlzdGVuZXIuc3NsLmNlcnRmaWxlID0gLi9jZXJ0LyRIT1NUTkFNRS5jcnQKbGlzdGVuZXIuc3NsLmtleWZpbGUgPSAuL2NlcnQvJEhPU1ROQU1FLmtleQpsaXN0ZW5lci5odHRwLmRlZmF1bHQgPSAwLjAuMC4wOjg4ODgKcGx1Z2lucy52bXFfcGFzc3dkID0gb2ZmCnBsdWdpbnMudm1xX2FjbCA9IG9mZgpwbHVnaW5zLnZtcV9rOHMucGF0aCA9IC92ZXJuZW1xL3BsdWdpbnMvX2J1aWxkL2RlZmF1bHQKcGx1Z2lucy52bXFfazhzID0gb24KbGV2ZWxkYi5tYXhpbXVtX21lbW9yeS5wZXJjZW50ID0gMjAKbG9nLmNvbnNvbGUgPSBjb25zb2xlCnBsdWdpbnMudm1xX3dlYmhvb2tzPW9uCnZtcV93ZWJob29rcy5kb2pvdF9wdWJsaXNoLmhvb2sgPSBvbl9wdWJsaXNoCnZtcV93ZWJob29rcy5kb2pvdF9wdWJsaXNoLmVuZHBvaW50ID0gaHR0cDovL3dlYmhvb2stdmVybmU6NDAwMC9wdWIKbGlzdGVuZXIubWF4X2Nvbm5lY3Rpb25zID0gMTAwMDAwCmxpc3RlbmVyLm5yX29mX2FjY2VwdG9ycyA9IDEwMAptYXhfaW5mbGlnaHRfbWVzc2FnZXMgPSAyMDAwCm1heF9vbmxpbmVfbWVzc2FnZXMgPSAxMDAwMA=="
  config:
    configs:
    - name: allow_register_during_netsplit
      value: "on"
    - name: allow_publish_during_netsplit
      value: "on"
    - name: allow_subscribe_during_netsplit
      value: "on"
    - name: allow_unsubscribe_during_netsplit
      value: "on"
    listeners:
    - address: 0.0.0.0
      port: 1883
    - address: 0.0.0.0
      port: 1888
      websocket: true
    plugins: []
  serviceAccountName: vernemq-k8s
  size: 1
  version: 1.9.0