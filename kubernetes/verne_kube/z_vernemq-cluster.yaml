apiVersion: vernemq.com/v1alpha1
kind: VerneMQ
metadata:
  labels:
    vernemq: k8s
  name: k8s
spec:
  baseImage: mprevide/verne
  env:
    - name: STATIC_CERT
      value: "n"
    - name: K8S_ENV
      value: "y"
    - name: CERT_EJBCA_API_BROKER
      value: "ejbca-simple"
    - name: CERT_EJBCA_API_PORT
      value: "5583"
    - name: CRL_UPDATE_TIME
      value: "* * * * *" #every 10 min "*/10 * * * *"
    - name: CHECK_EXPIRATION_TIME
      value: "* * * * *" #every 10 min "*/10 * * * *"
    - name: CHECKEND_EXPIRATION_SEC
      value: "60" #24h  86400
    ## BASE-64 config
    - name: VERNEMQ_CONF
      value: "bWV0YWRhdGFfcGx1Z2luID0gdm1xX3N3YwpsaXN0ZW5lci52bXEuY2x1c3RlcmluZyA9ICRNWV9QT0RfSVA6NDQwNTMKbGlzdGVuZXIuc3NsLmRlZmF1bHQgPSAwLjAuMC4wOjg4ODMKbGlzdGVuZXIuc3NsLmNhZmlsZSA9IC92ZXJuZW1xL2NlcnQvY2EuY3J0Cmxpc3RlbmVyLnNzbC5jZXJ0ZmlsZSA9IC92ZXJuZW1xL2NlcnQvJEhPU1ROQU1FLmNydApsaXN0ZW5lci5zc2wua2V5ZmlsZSA9IC92ZXJuZW1xL2NlcnQvJEhPU1ROQU1FLmtleQpsaXN0ZW5lci5zc2wuY3JsZmlsZSA9IC92ZXJuZW1xL2NlcnQvY2EuY3JsCmxpc3RlbmVyLmh0dHAuZGVmYXVsdCA9IDAuMC4wLjA6ODg4OApwbHVnaW5zLnZtcV9wYXNzd2QgPSBvZmYKcGx1Z2lucy52bXFfYWNsID0gb2ZmCnBsdWdpbnMudm1xX2s4cy5wYXRoID0gL3Zlcm5lbXEvcGx1Z2lucy9fYnVpbGQvZGVmYXVsdApwbHVnaW5zLnZtcV9rOHMgPSBvbgpsZXZlbGRiLm1heGltdW1fbWVtb3J5LnBlcmNlbnQgPSAyMApsb2cuY29uc29sZSA9IGNvbnNvbGUKcGx1Z2lucy52bXFfd2ViaG9va3M9b24Kdm1xX3dlYmhvb2tzLmRvam90X3JlZ2lzdGVyLmhvb2sgPSBhdXRoX29uX3JlZ2lzdGVyCnZtcV93ZWJob29rcy5kb2pvdF9yZWdpc3Rlci5lbmRwb2ludCA9IGh0dHA6Ly93ZWJob29rLXZlcm5lOjQwMDAvcmVnCnZtcV93ZWJob29rcy5kb2pvdF9wdWJsaXNoLmhvb2sgPSBhdXRoX29uX3B1Ymxpc2gKdm1xX3dlYmhvb2tzLmRvam90X3B1Ymxpc2guZW5kcG9pbnQgPSBodHRwOi8vd2ViaG9vay12ZXJuZTo0MDAwL3B1Ygp2bXFfd2ViaG9va3MuZG9qb3Rfc3Vic2NyaWJlLmhvb2sgPSBhdXRoX29uX3N1YnNjcmliZQp2bXFfd2ViaG9va3MuZG9qb3Rfc3Vic2NyaWJlLmVuZHBvaW50ID0gaHR0cDovL3dlYmhvb2stdmVybmU6NDAwMC9zdWIKbGlzdGVuZXIubWF4X2Nvbm5lY3Rpb25zID0gMjAwMDAwCmxpc3RlbmVyLm5yX29mX2FjY2VwdG9ycyA9IDEwMAptYXhfaW5mbGlnaHRfbWVzc2FnZXMgPSAyMAptYXhfb25saW5lX21lc3NhZ2VzID0gMTAwMDA"
  config:
    configs:
    - name: allow_register_during_netsplit
      value: "on"
    - name: allow_publish_during_netsplit
      value: "on"
    - name: allow_subscribe_during_netsplit
      value: "on"
    - name: allow_unsubscribe_during_netsplit
      value: "on"
    listeners:
    - address: 0.0.0.0
      port: 1883
    - address: 0.0.0.0
      port: 1888
      websocket: true
    plugins: []
  serviceAccountName: vernemq-k8s
  size: 1
  version: 1.9.0
  tag: latest
